以下のMarkdownは、このプロジェクトにおける「前提思想ドキュメント」です。

あなた（Antigravity）は、以下を理解した上で振る舞ってください。

- 本システムは TERASOLUNA 見積り手順を大前提としています
- AI（Agent）は判断・説明のみを行い、数値を決めてはいけません
- 計算は Calc API のみが行います
- 見積り手法（Screen / STEP / FP）は理由なしに選択してはいけません
- 自由記述は DRAFT、UI選択のみが FACT です
- 営業・PMが説明責任を果たせることが最優先です

この前提に反する設計・実装・提案は行わないでください。

---

（Why TERASOLUNA is Mandatory）

1. このドキュメントの目的

本ドキュメントは、
AI概算見積りシステムがなぜ TERASOLUNA を大前提として設計されているのかを明確にするためのものである。

対象読者は以下を想定する。

Antigravity（エージェントコーディング環境）

設計・実装を行う開発者

営業・PM・品質保証部門

将来この仕組みに手を入れるメンバー

2. 結論（最重要）

本システムは、
自社（NTTデータグループ）の開発手法である TERASOLUNA に基づいた見積りを、
営業・PMが実務で使える形で再現することを目的としている。

単なる「AIによる金額提示」ではなく、
説明責任・再現性・根拠を伴う概算見積りを実現するため、
TERASOLUNAの思想と手順をシステム構造そのものに組み込んでいる。

3. なぜ TERASOLUNA を前提にしなければならないのか
3.1 自社の見積りは「計算」ではなく「判断プロセス」

TERASOLUNAの見積り手順は、以下のような判断の順序を持つ。

見積り手法の選定（Screen / STEP / FP）

規模の把握

生産性・工数の決定

原価算出

リスク・予備費の考慮

根拠の明文化

この順序と根拠を守らない見積りは、
社内レビュー・顧客説明に耐えない。

👉 したがって、TERASOLUNAを無視したAI見積りは
自社では実務利用できない。

4. AIと TERASOLUNA の役割分担
4.1 AI（Agent / Azure OpenAI）の役割

自由記述から文脈・意図を理解する

TERASOLUNAに基づき「選択肢」を提示する

なぜその手法・選択が妥当かを言語化する

ユーザーに明示的な確認を促す

※ AIは数値を決めない／計算しない

4.2 Calc API（コード）の役割

ユーザーが確定した FACT のみを受け取る

事前に定義された式・係数で計算する

デフォルト値や推測を一切持たない

前提が欠けていればエラーを返す

※ Calc は純粋な計算機であり、判断を行わない

5. チャットUIの本質的な意味

本システムのチャットUIは、雑談インターフェースではない。

自由記述：意図把握用（DRAFT）

選択肢UI：見積り前提の確定（FACT）

確定操作のみが計算に反映される

👉
TERASOLUNAの見積り入力票を、
会話形式で段階的に埋めているだけである。

6. 営業・PMにとっての価値

本システムにより、以下が可能になる。

見積り手法選定理由の自動言語化

内製／外注を分けた二層見積り（Vendor Mixed）

不確実性を含めたレンジ提示

入力 → 計算 → 結果のログ保存（説明責任）

👉
TERASOLUNAに精通していない営業でも、
TERASOLUNA準拠の概算見積りを出せる

7. なぜこの設計は壊れにくいのか

判断と計算を構造的に分離している

見積りルールは YAML / Code に固定されている

Snapshot により前提と結果が保存される

AIを差し替えても計算ロジックは変わらない

👉
TERASOLUNAを「知識」ではなく「構造」として実装している

8. まとめ（Invariant）

本システムは TERASOLUNA を前提とする

AIは判断支援、決定はユーザー、計算はコード

見積りは常に説明可能でなければならない

この前提を守る限り、
設計を拡張しても、将来修正しても、必ず整合性を保てる。
