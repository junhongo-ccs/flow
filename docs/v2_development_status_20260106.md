# AI見積もりシステム V2：開発ステータスと今後のタスク (2026/01/06)

本ドキュメントは、これまでに実施したUI改善・安定化作業の記録と、次フェーズに向けた残タスクをまとめたものです。

---

## 1. これまでに完了したこと (Done)

### UI/UXの改善と安定化
- **「鉄壁のハイブリッド抽出」の実装**:
    - ブラケット形式(`[ ]`)とリスト形式(`-`)の双方から選択肢を漏らさず抽出するロジックをbackend(`app.py`)に導入。
    - AIがボールド表記(`**`)や補足説明(`: `)を含めて回答しても、クリーンなラベルとしてボタン化できる仕様に変更。
- **究極のクリーンアップ処理**:
    - frontend(`app.js`)にて、ボタン化した項目を行単位で丸ごと消去するロジックを実装。ハイフンや空のブラケットが残る問題を根絶。
- **ヒアリングフローのスリム化と復活**:
    - プロンプトを調整し、「概要説明」の直後に「機能提案」がボタンで並ぶように設計。
    - ユーザーの要望に基づき、「ターゲットユーザー」設問も完璧なボタンUIで表示されることを実機検証済み。

### インフラ・デプロイの安定化
- **デプロイ環境の最適化**:
    - Azureビルド時の「ディスク容量不足(No space left on device)」エラーを回避するため、`.dockerignore`を最適化(venvフォルダ等の除外)。
- **CORS・APIエラーの修正**:
    - backendの`re`モジュールインポート漏れなどの致命的不具合を修正。
    - ローカル開発環境とAzure本番環境のCORS設定を整理。

---

## 2. 現在のステータス (Current)
- **UIステータス**: すべての設問（ターゲットユーザー、機能、技術、デザイン段階など）が安定してボタン表示され、履歴もクリーンに保たれています。
- **環境**: Azure Container Apps (backend) と GitHub Pages (frontend) に最新版が反映済み。

---

## 3. 明日以降の残タスク (To Do)

### A. フェーズD：確認・見積もりロジックの精度向上
- [ ] **計算ロジックの最終調整**: 選択された機能や画面数に基づき、`pricing_matrix.md`から正確な算出し、詳細な見積もり根拠を出力すること。
- [ ] **提案書Markdownの洗練**: AIが生成する「プロジェクト見積もり・提案書」のフォーマットを、よりビジネス資料として遜色ないレベルへ磨き上げる。

### B. ユーザー体験のさらなる向上
- [ ] **「戻る」ボタンの実装**: 会話の途中で前の設問に戻り、選択をやり直せる機能（要検討）。
- [ ] **自由記述の反映強化**: ボタンにない機能が自由記述された際、それを見積もりに正しく反映するロジックの強化。

### C. 保守・運用
- [ ] **ログの可視化**: どのような案件が相談されているか、 backend側でセッションログを分析しやすい形式で保存。

---

## 4. 参考リンク
- [V2 基本設計書](v2_basic_design.md)
- [技術スタック](v2_technical_stack.md)
